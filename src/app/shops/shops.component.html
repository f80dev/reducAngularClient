<mat-card *ngFor="let shop of user.shops" class="app-card">
  <mat-card-header>
    <div mat-card-avatar (click)="shop.visible=!shop.visible">
      <img [src]="config.values.icon_card_shop" style="width:50px;height:50px;">
    </div>
    <mat-card-title (click)="shop.visible=!shop.visible">{{shop.name}}</mat-card-title>
    <span class="spacer"></span>
    <div style="display: inline-block;cursor: pointer;" (click)="shop.visible=!shop.visible">
      <mat-icon *ngIf="!shop.visible">arrow_drop_down</mat-icon>
      <mat-icon *ngIf="shop.visible">arrow_drop_up</mat-icon>
    </div>

    <mat-card-subtitle>{{shop.address}}</mat-card-subtitle>
  </mat-card-header>


  <mat-card-content class="app-card-content" *ngIf="shop.visible">
    <div id="print-section-{{shop._id}}" style="display: none;">
      <app-print-coupon [shop]="shop"></app-print-coupon>
    </div>

    <span *ngIf="shop.followers?.length>0">
      Vous avez {{shop.followers?.length}} followers
    </span>

    <!--<app-new-coupon *ngIf="shop.showAddCoupon"-->
                    <!--name="zoneNewCoupon"-->
                    <!--[shop]="shop"-->
                    <!--[level]="user.level"-->
                    <!--(insert)="onInsert(shop)"-->
                    <!--(close)="shop.showAddCoupon=false">-->
    <!--</app-new-coupon>-->

    <app-tuto [delay]="1"
              [if]="shop.coupons?.length>0"
              label="Une fois votre première promotion créée, vous pouvez, imprimer une affiche ou diffuser son lien internet à votre réseau">
    </app-tuto>


    <br>
    <app-list-coupons [coupons]="shop.coupons" [user]="user"
                      (delete)="onupdate.emit($event)"
                      (edit)="edit(shop,$event)">
    </app-list-coupons>


  </mat-card-content>

  <app-scanner [size]="300"
               *ngIf="showWebCam && shop.visible"
               [filter]=""
               (flash)="onFlash_event($event,shop)">
  </app-scanner>

  <mat-card-actions class="app-card-action" *ngIf="shop.visible">

    <button mat-button name="btnDelegate"
            (click)="setDelegate(shop)"
            title="Déléguer l'encaissement"
            mat-flat-button mat-icon-button>
      <mat-icon>person_add</mat-icon>
    </button>


    <button mat-button name="btnPrint"
            (click)="openPrinter(shop)"
            ngxClipboard [cbContent]="shop.url"
            title="Imprimer le QRCode de l'enseigne"
            mat-flat-button mat-icon-button>
      <mat-icon>printer</mat-icon>
    </button>

    <button mat-button mat-flat-button mat-icon-button
            *ngIf="coupons?.length==0"
            (click)="delShop(shop)">
      <mat-icon>delete</mat-icon>
    </button>

    <button mat-button mat-flat-button mat-icon-button
            name="btnNewPromoAdvanced"
            *ngIf="user.level>0"
            (click)="addCoupon(shop)">
      <mat-icon>note_add</mat-icon>
    </button>

    <button mat-button mat-flat-button
            name="btnNewPromo" class="large-button"
            *ngIf="user.level==0"
            (click)="addCoupon(shop)">
      Nouvelle promotion
    </button>

  </mat-card-actions>

</mat-card>

