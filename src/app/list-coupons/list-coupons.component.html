<mat-card *ngFor="let coupon of coupons" class="app-card">
  <mat-card-header (click)="coupon.visible=!coupon.visible">
    <div mat-card-avatar class="header-image"></div>
    <mat-card-title style="font-size: medium;">
        {{coupon.label}}&nbsp;chez "{{coupon.shop_complete.name}}"
    </mat-card-title>
    <mat-card-subtitle *ngIf="!coupon.visible">

      <span *ngIf="coupon._id!=coupon.origin" style="font-size: large">
        <strong>{{coupon.gain}}</strong>&nbsp;{{coupon.unity}}

        <span *ngIf="(coupon.gain/coupon.max)>0.8">
        (max:{{coupon.max}})
          </span>
      </span>

    <span *ngIf="coupon._id==coupon.origin">
           Nombre de coupon créés : {{coupon.share}} / {{coupon.max_coupon}}
      </span>


    </mat-card-subtitle>
  </mat-card-header>

  <mat-card-content class="app-card-content" *ngIf="coupon.visible">

    <app-tuto [delay]="20" label="Cliquer sur le titre pour réduire la taille d'affichage du coupon"></app-tuto>

    <div name="print-section" style="display: none;">
      <div style="text-align: center;width:100%;">
        <h2>
          {{coupon.label}}&nbsp;chez "{{coupon.shop_complete.name}}"
        </h2>
        <br>
        <br>
        <span style="font-size: 2em;">
          Gagner immédiatement <strong>{{coupon.direct_bonus}}</strong>&nbsp;{{coupon.unity}}
        </span>
        <br>
        <br>
        <h3>Flasher ce code pour en bénéficier</h3>

        <qr-code [value]="coupon.url"
                 style="max-width:200px;max-height: 200px;display:inline;"
                 [size]="400">
        </qr-code>
        <br><br>

        <br><br><br>
        <h1>Votre réduction peut facilement augmenter !</h1>

        <div style="font-size: xx-large">
          de <strong>{{coupon.share_bonus}}</strong>&nbsp;{{coupon.unity}} à chaque fois que vous la partagez avec vos proches<br><br>
          de <strong>{{coupon.pay_bonus}}</strong>&nbsp;{{coupon.unity}} à chaque fois qu'un client utilise le coupon que vous lui avez partagez
        </div>



      </div>

    </div>

    <!--Visuel du coupon-->
    <table style="width:100%;vertical-align: top;"><tr>
      <td style="width:30%;">
        <img
          *ngIf="(coupon.showCode==null || !coupon.showCode) && coupon.picture?.length>0"
          [src]="coupon.picture"
          style="height: 175px;">
          <!--QRCode du coupon-->

            <qr-code [value]="coupon.url"
                     style="max-width:200px;max-height: 200px;display:inline;"
                     *ngIf="coupon.showCode"
                     [size]="175">
            </qr-code>


      </td>
      <td style="text-align: center;vertical-align: top;width:50%;">
        <div style="display:inline-block;font-size: larger;" *ngIf="coupon._id!=coupon.origin">
          Vous avez déjà gagné {{coupon.gain}}&nbsp;{{coupon.unity}}
          <span *ngIf="coupon.gain/coupon.max>0.8">(/{{coupon.max}})</span>
        </div>
        <br><br>

        <!--Zone réserver au créateur-->
        <div *ngIf="coupon._id==coupon.origin" style="font-size: small;">
          Nombre de coupon créés : {{coupon.share}} / {{coupon.max_coupon}}
          <br><br>
        </div>
          <table style="text-align: left;display: inline-block;font-size: small;" cellpadding="4">
            <tr><td>Partage</td><td>+{{coupon.share_bonus}}</td></tr>
            <tr><td>Achat</td><td>+{{coupon.pay_bonus}}</td></tr>
            <tr><td>Direct</td><td>+{{coupon.direct_bonus}}</td></tr>
          </table><br><br>
          <span style="font-size: small">
            Validitée : <strong><app-timer [end]="coupon.dtEnd"></app-timer></strong>
          </span>
      </td>
    </tr></table>


    <app-tuto [if]="coupon.showCode && coupon.visible" [delay]="3"
              label="Le lien du coupon est disponible dans le presse-papier, vous pouvez l'envoyer par WhatsApp, SMS, Messenger ... etc ...">
    </app-tuto>

    <app-tuto [delay]="2" [duration]="15"
              label="Augmenter votre réduction en partageant cette réduction avec votre réseau">
    </app-tuto>

  </mat-card-content>

    <!--Info sur le coupon-->

    <mat-card-actions style="text-align: center;">


      <div *ngIf="coupon.share<coupon.max_coupon" style="display: inline-block;">
        <button mat-button mat-flat-button
                title="Partager le coupon pour augmenter votre promotion / réduction"
                mat-icon-button (click)="showCode(coupon)"
                ngxClipboard [cbContent]="coupon.url">
          <mat-icon>share</mat-icon>
        </button>

        <!--<button mat-button mat-flat-button-->
                <!--mat-icon-button (click)="socialSharing(coupon)" >-->
          <!--<span style="font-size: x-large">f</span>-->
        <!--</button>-->

        <!--<button mat-button mat-flat-button-->
                <!--mat-icon-button (click)="socialSharing(coupon)" >-->
          <!--<span style="font-size: large">g+</span>-->
        <!--</button>-->

      </div>
      &nbsp;


      <!--<button mat-button mat-flat-button mat-icon-button (click)="showInfos(coupon)">-->
        <!--<mat-icon>attach_money</mat-icon>-->
      <!--</button>-->

      <button *ngIf="coupon._id==coupon.origin && coupon.visible" mat-button
              (click)="openPrinter(coupon)"
              title="Imprimer une affiche de votre bon plan"
              mat-flat-button mat-icon-button>
        <mat-icon>printer</mat-icon>
      </button>

      <button mat-button mat-flat-button
              *ngIf="coupon._id!=coupon.origin"
              title="Localiser l'enseigne proposant la réduction"
              mat-icon-button  (click)="showAddress(coupon.shop_complete)">
        <mat-icon>map</mat-icon>
      </button>

      <button mat-button mat-flat-button
              mat-icon-button
              (click)="remove(coupon)">
        <mat-icon>delete</mat-icon>
      </button>
    </mat-card-actions>
</mat-card>
<br>
