<mat-card class="app-card">
  <mat-card-header>
    <mat-card-title>
      <div style="display:inline-block;width:100px;vertical-align: middle;">
        <label for="file_profil"><img mat-card-avatar style="width:70px;height:70px;" [src]="user.photo"></label>
        <input style="display:none;width:50px;" type="file" id="file_profil"
               (change)="onSelectFile($event)"
               accept="image/gif,image/jpeg,image/png" />

      </div>
      <span *ngIf="!user.email?.endsWith('fictif.com')">{{user.email}}</span>
      <span *ngIf="user.pseudo?.length>0" (click)="promptForPseudo()">{{user.pseudo}}</span>
      <button *ngIf="user.pseudo?.length==0" mat-button mat-flat-button (click)="promptForPseudo()">Pseudo ?</button>
      <mat-progress-spinner *ngIf="config.waiting"></mat-progress-spinner>

    </mat-card-title>

    <mat-card-subtitle *ngIf="user.message?.length>0">{{user.message}}</mat-card-subtitle>
    <app-tuto label="Cette zone affiche les informations de votre profil"></app-tuto>
  </mat-card-header>
  <mat-card-content class="app-card-content">
    <div style="width:100%;text-align: center;" *ngIf="showScanner">
      <webcam
              [height]="400" [width]="400"
              [trigger]="triggerObservable"
              [allowCameraSwitch]="false"
              [imageQuality]="0.85"
              [captureImageData]="true"
              imageType="image/jpeg"
              (imageCapture)="handleImage($event)">
      </webcam>
    </div>

    <!--Montre la carte des promotions-->
    <div *ngIf="showMap">
      <div id="map" class="map" style="width:95%;display: inline-block;"></div>
      <br>
      <app-list-coupons *ngIf="showCouponOnMap"
                        [user]="user"
                        (flash)="flash($event)"
                        [coupons]="showCouponOnMap">
      </app-list-coupons>
    </div>



    <app-old-coupons [user]="user"
                     *ngIf="showOldPromos">
    </app-old-coupons>

    <app-tuto [delay]="5" icon="map"
              label="Vous pouvez voir les promos autour de vous en activant la carte">
    </app-tuto>


    <app-tuto [delay]="6" icon="delete" [if]="user.shops==null || user.shops.length==0"
              label="Vous pouvez totalement effacer votre compte de reducShare">
    </app-tuto>


  </mat-card-content>
  <mat-card-actions class="app-card-action">
    <!--<button mat-button mat-raised-button (click)="showOldPromos=!showOldPromos">Mes promos</button>-->

    <button mat-icon-button mat-button mat-raised-button
            *ngIf="user.shops==null || user.shops.length==0"
            (click)="clearAccount(user._id)">
      <mat-icon>delete</mat-icon>
    </button>


    <button *ngIf="webcamsAvailable>0" mat-button mat-raised-button (click)="startScanner()">
      Scanner une promotion
    </button>

    <button mat-icon-button mat-button mat-raised-button (click)="openLoc()">
      <mat-icon>map</mat-icon>
    </button>

    <button mat-button mat-raised-button (click)="addshop()">
      <span *ngIf="user.shops==null || user.shops.length==0">
        Cr√©er sa promotion
      </span>
      <span *ngIf="user.shops?.length>0">
        Ajouter une enseigne
      </span>
    </button>
  </mat-card-actions>
</mat-card>
